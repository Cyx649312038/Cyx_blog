<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽象值操作 | Cyx～</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/cyx_blog/assets/images/pageLogo.png">
    <meta name="description" content="用于平时学习记录的笔记文档">
    <meta name="author" content="cyx">
    <meta name="Keywords" content="个人笔记">
    
    <link rel="preload" href="/cyx_blog/assets/css/0.styles.3178a8c9.css" as="style"><link rel="preload" href="/cyx_blog/assets/js/app.ebd8d218.js" as="script"><link rel="preload" href="/cyx_blog/assets/js/2.080a46d6.js" as="script"><link rel="preload" href="/cyx_blog/assets/js/23.de7b4abf.js" as="script"><link rel="prefetch" href="/cyx_blog/assets/js/10.d187e49f.js"><link rel="prefetch" href="/cyx_blog/assets/js/11.bfac635a.js"><link rel="prefetch" href="/cyx_blog/assets/js/12.167a9869.js"><link rel="prefetch" href="/cyx_blog/assets/js/13.5e1ef22e.js"><link rel="prefetch" href="/cyx_blog/assets/js/14.266321ac.js"><link rel="prefetch" href="/cyx_blog/assets/js/15.a0db7f52.js"><link rel="prefetch" href="/cyx_blog/assets/js/16.c3bd7f75.js"><link rel="prefetch" href="/cyx_blog/assets/js/17.850a33d5.js"><link rel="prefetch" href="/cyx_blog/assets/js/18.03baacf6.js"><link rel="prefetch" href="/cyx_blog/assets/js/19.e5ecc5cf.js"><link rel="prefetch" href="/cyx_blog/assets/js/20.84e71789.js"><link rel="prefetch" href="/cyx_blog/assets/js/21.0caa4d0f.js"><link rel="prefetch" href="/cyx_blog/assets/js/22.cd5e3d76.js"><link rel="prefetch" href="/cyx_blog/assets/js/24.902ad754.js"><link rel="prefetch" href="/cyx_blog/assets/js/25.4982f003.js"><link rel="prefetch" href="/cyx_blog/assets/js/26.b26cd10d.js"><link rel="prefetch" href="/cyx_blog/assets/js/27.0b792ce1.js"><link rel="prefetch" href="/cyx_blog/assets/js/28.9270dd34.js"><link rel="prefetch" href="/cyx_blog/assets/js/29.5dc2abbe.js"><link rel="prefetch" href="/cyx_blog/assets/js/3.321db5fe.js"><link rel="prefetch" href="/cyx_blog/assets/js/30.718bae68.js"><link rel="prefetch" href="/cyx_blog/assets/js/31.964cb332.js"><link rel="prefetch" href="/cyx_blog/assets/js/32.9da046ff.js"><link rel="prefetch" href="/cyx_blog/assets/js/33.f9e6634f.js"><link rel="prefetch" href="/cyx_blog/assets/js/34.34ac8e0c.js"><link rel="prefetch" href="/cyx_blog/assets/js/35.a763a0be.js"><link rel="prefetch" href="/cyx_blog/assets/js/36.a890cb02.js"><link rel="prefetch" href="/cyx_blog/assets/js/37.1c7e8019.js"><link rel="prefetch" href="/cyx_blog/assets/js/38.a4ab6049.js"><link rel="prefetch" href="/cyx_blog/assets/js/39.1fd5ccb6.js"><link rel="prefetch" href="/cyx_blog/assets/js/4.0704d8fe.js"><link rel="prefetch" href="/cyx_blog/assets/js/40.fe6c7787.js"><link rel="prefetch" href="/cyx_blog/assets/js/41.5a66ba75.js"><link rel="prefetch" href="/cyx_blog/assets/js/42.1d56113a.js"><link rel="prefetch" href="/cyx_blog/assets/js/43.2f654199.js"><link rel="prefetch" href="/cyx_blog/assets/js/44.081f7e06.js"><link rel="prefetch" href="/cyx_blog/assets/js/45.d8c3fbd6.js"><link rel="prefetch" href="/cyx_blog/assets/js/46.f0175cde.js"><link rel="prefetch" href="/cyx_blog/assets/js/5.11b70e0a.js"><link rel="prefetch" href="/cyx_blog/assets/js/6.74c239f2.js"><link rel="prefetch" href="/cyx_blog/assets/js/7.67a47de0.js"><link rel="prefetch" href="/cyx_blog/assets/js/8.e668bce6.js"><link rel="prefetch" href="/cyx_blog/assets/js/9.086a537d.js">
    <link rel="stylesheet" href="/cyx_blog/assets/css/0.styles.3178a8c9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cyx_blog/" class="home-link router-link-active"><img src="/cyx_blog/assets/images/logo.png" alt="Cyx～" class="logo"> <span class="site-name can-hide">Cyx～</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/cyx_blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/cyx_blog/bookReading/" class="nav-link router-link-active">
  bookReading
</a></div><div class="nav-item"><a href="/cyx_blog/typescript/" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/cyx_blog/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/cyx_blog/project/" class="nav-link">
  project
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/cyx_blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/cyx_blog/bookReading/" class="nav-link router-link-active">
  bookReading
</a></div><div class="nav-item"><a href="/cyx_blog/typescript/" class="nav-link">
  typescript
</a></div><div class="nav-item"><a href="/cyx_blog/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/cyx_blog/project/" class="nav-link">
  project
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/cyx_blog/bookReading/" class="sidebar-heading clickable router-link-active open"><span>前端书籍阅读</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/cyx_blog/bookReading/dont_know_js 01/" class="sidebar-heading clickable"><span>你不知道的JS(上)</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/cyx_blog/bookReading/dont_know_js 02/" class="sidebar-heading clickable open"><span>你不知道的JS(中)</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/cyx_blog/bookReading/dont_know_js 02/01-type.html" class="sidebar-link">1. 类型</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/02-value.html" class="sidebar-link">2.值</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/03-nativeFunction.html" class="sidebar-link">3.原生函数</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html" class="active sidebar-link">4.强制类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#抽象值操作" class="sidebar-link">抽象值操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#tostring" class="sidebar-link">ToString</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#json-stringify" class="sidebar-link">JSON.stringify(...)</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#tonumber" class="sidebar-link">ToNumber</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#toboolean" class="sidebar-link">ToBoolean</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#显式强制类型转换" class="sidebar-link">显式强制类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#字符串和数字之间" class="sidebar-link">字符串和数字之间</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#显式解析数字字符串" class="sidebar-link">显式解析数字字符串</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#显式转换为布尔值" class="sidebar-link">显式转换为布尔值</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#隐式强制类型转换" class="sidebar-link">隐式强制类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#字符串和数字" class="sidebar-link">字符串和数字</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#布尔值和数字" class="sidebar-link">布尔值和数字</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#和" class="sidebar-link">||和&amp;&amp;</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#宽松相等和严格相等" class="sidebar-link">宽松相等和严格相等</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#" class="sidebar-link">&quot;==&quot;</a></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#一些不常见的情况" class="sidebar-link">一些不常见的情况</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyx_blog/bookReading/dont_know_js 02/04-Cast.html#抽象关系比较" class="sidebar-link">抽象关系比较</a></li></ul></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/05-grammar.html" class="sidebar-link">5.语法</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/06-async.html" class="sidebar-link">6.异步和性能</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/07-callback.html" class="sidebar-link">7.回调</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/08-promise.html" class="sidebar-link">8.promise</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/09-generator.html" class="sidebar-link">9.生成器</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/10-programPerformance.html" class="sidebar-link">10.程序性能</a></li><li><a href="/cyx_blog/bookReading/dont_know_js 02/11-performanceTestingAndTuning.html" class="sidebar-link">11.性能测试与调优</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/cyx_blog/bookReading/dont_know_js 03/" class="sidebar-heading clickable"><span>你不知道的JS(下)</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/cyx_blog/bookReading/javaScriptRedBook/" class="sidebar-link">javaScript程序设计(第四版)</a></li><li><a href="/cyx_blog/bookReading/illustrateHttp/" class="sidebar-link">图解Http</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="抽象值操作"><a href="#抽象值操作" class="header-anchor">#</a> 抽象值操作</h2> <p>ES5 规范第 9 节中定义了一些“抽象操作”(即“仅供内部使用的操作”)和转 换规则。这里我们着重介绍 ToString、ToNumber 和 ToBoolean，附带讲一讲 ToPrimitive。</p> <h3 id="tostring"><a href="#tostring" class="header-anchor">#</a> ToString</h3> <p>基本类型值的字符串化规则为:null 转换为 &quot;null&quot;，undefined 转换为 &quot;undefined&quot;，true 转换为 &quot;true&quot;。数字的字符串化则遵循通用规则，不过第 2 章中讲过的那些极小和极大的 数字使用指数形式:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.07 连续乘以七个 1000</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1.07</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">// 七个1000一共21位数字 </span>
a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;1.07e21&quot;</span>
</code></pre></div><p>对普通对象来说，除非自行定义，否则 toString()(Object.prototype.toString())返回 内部属性 [[Class]] 的值(参见第 3 章)，如 &quot;[object Object]&quot;。</p> <p>数组的默认 toString() 方法经过了重新定义，将所有单元字符串化以后再用 &quot;,&quot; 连接起 来: [1,2,3].toString // 1,2,3</p> <p>toString() 可以被显式调用，或者在需要字符串化时自动调用。</p> <h3 id="json-stringify"><a href="#json-stringify" class="header-anchor">#</a> JSON.stringify(...)</h3> <p>工具函数 JSON.stringify(..) 在将 JSON 对象序列化为字符串时也用到了 ToString。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token number">42</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;42&quot;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token string">&quot;42&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;42&quot;&quot;(含有双引号的字符串) </span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token keyword">null</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;null&quot;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;true&quot;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>undefined、function、symbol (ES6+)和包含循环引用(对象之间相互引用，形成一个无限循环)的对象都不符合 JSON
结构标准，支持 JSON 的语言无法处理它们。JSON.stringify(..) 在对象中遇到 undefined、function 和 symbol 时会自动将其忽略，在
数组中则会返回 null(以保证单元位置不变)</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token keyword">undefined</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">undefined</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// &quot;[1,null,null,4]&quot;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token function-variable function">b</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>                              <span class="token comment">// {a:2}</span>
<span class="token comment">//  对包含循环引用的对象执行 JSON.stringify(..) 会出错。</span>
<span class="token comment">// a = {</span>
<span class="token comment">//     o: {</span>
<span class="token comment">//         a</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
</code></pre></div><blockquote><p>如果对象中定义了 toJSON() 方法，JSON 字符串化时会首先调用该方法，然后用它的返回 值来进行序列化。toJSON() 应该“返回一个能够被字符串化的安全的 JSON 值”，而不是“返回 一个 JSON 字符串”。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// 可能是我们想要的结果! </span>
    <span class="token function-variable function">toJSON</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// 可能不是我们想要的结果! </span>
    <span class="token function-variable function">toJSON</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
             <span class="token keyword">return</span> <span class="token string">&quot;[&quot;</span> <span class="token operator">+</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span> 
            <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[2,3]&quot;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;[2,3]&quot;&quot;</span>
</code></pre></div><p>我们可以向 JSON.stringify(..) 传递一个可选参数 replace</p> <p>如果 replacer 是一个数组，那么它必须是一个字符串数组，其中包含序列化要处理的对象 的属性名称，除此之外其他的属性则被忽略。</p> <p>如果 replacer 是一个函数，它会对对象本身调用一次，然后对对象中的每个属性各调用 一次，每次传递两个参数，键和值。如果要忽略某个键就返回 undefined，否则返回指定 的值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> 
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token comment">//由于字符串化是递归的，因 此数组 [1,2,3] 中的每个元素都会通过参数 v 传递给 replacer，即 1、2 和 3， 参数 k 是它们的索引值，即 0、1 和 2。</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;{&quot;b&quot;:42,&quot;c&quot;:&quot;42&quot;}&quot;</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">k<span class="token punctuation">,</span>v</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">!==</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">// &quot;{&quot;b&quot;:42,&quot;d&quot;:[1,2,3]}&quot;</span>
</code></pre></div><blockquote><p>JSON.string 还有一个可选参数 space，用来指定输出的缩进格式。</p></blockquote> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>(1) 字符串、数字、布尔值和 null 的 JSON.stringify(..) 规则与 ToString 基本相同。
(2) 如果传递给 JSON.stringify(..) 的对象中定义了 toJSON() 方法，那么该方法会在字符
串化前调用，以便将对象转换为安全的 JSON 值。</p></div> <h2 id="tonumber"><a href="#tonumber" class="header-anchor">#</a> ToNumber</h2> <h2 id="toboolean"><a href="#toboolean" class="header-anchor">#</a> ToBoolean</h2> <h2 id="显式强制类型转换"><a href="#显式强制类型转换" class="header-anchor">#</a> 显式强制类型转换</h2> <h3 id="字符串和数字之间"><a href="#字符串和数字之间" class="header-anchor">#</a> 字符串和数字之间</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注意不带new 不是封装对象</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">&quot;3.14&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span> c <span class="token punctuation">)</span><span class="token punctuation">;</span>
b<span class="token punctuation">;</span> <span class="token comment">// &quot;42&quot;</span>
d<span class="token punctuation">;</span> <span class="token comment">// 3.14</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">&quot;3.14&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token operator">+</span>c<span class="token punctuation">;</span>
b<span class="token punctuation">;</span> <span class="token comment">// &quot;42&quot;</span>
d<span class="token punctuation">;</span> <span class="token comment">// 3.14</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>toString() 对 42 这样的基本类型值不适用，所以 JavaScript 引擎会自动为 42 创建一个封 装对象(参见第 3 章)，然后对该对象调用 toString()。</p></div> <blockquote><p>上例中 +c 是 + 运算符的一元(unary)形式(即只有一个操作数)。+ 运算符显式地将 c 转 换为数字，而非数字加法运算(也不是字符串拼接，见下)。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">&quot;3.14&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">+</span> <span class="token operator">+</span>c<span class="token punctuation">;</span>
d<span class="token punctuation">;</span> <span class="token comment">// 8.14</span>
</code></pre></div><ol><li>日期显式转换为数字</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> timestamp <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timestamp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> timestamp <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>我们不建议对日期类型使用强制类型转换，应该使用 Date.now() 来获得当前的时间戳，使
用 new Date(..).getTime() 来获得指定时间的时间戳。</p></div> <ol start="2"><li>~运算符
~x 大致等同于 -(x+1）</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">~</span><span class="token number">42</span>  <span class="token comment">//-43</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
<span class="token operator">~</span>a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot;lo&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// -4 // true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">~</span>a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot;lo&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
<span class="token comment">// 找到匹配!</span>
<span class="token punctuation">}</span>
<span class="token operator">~</span>a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot;ol&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 0</span>
<span class="token operator">!</span><span class="token operator">~</span>a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot;ol&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">~</span>a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot;ol&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// true </span>
<span class="token comment">// 没有找到匹配!</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>在 -(x+1) 中唯一能够得到 0(或者严格说是 -0)的 x 值是 -1。也就是说如果 x 为 -1 时，~
和一些数字值在一起会返回假值 0，其他情况则返回真值。</p></div> <h3 id="显式解析数字字符串"><a href="#显式解析数字字符串" class="header-anchor">#</a> 显式解析数字字符串</h3> <p>解析允许字符串中含有非数字字符，解析按从左到右的顺序，如果遇到非数字字符就停 止。而转换不允许出现非数字字符，否则会失败并返回 NaN。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;42px&quot;</span><span class="token punctuation">;</span>
<span class="token function">Number</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 42</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 42</span>
<span class="token function">Number</span><span class="token punctuation">(</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// NaN</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 42</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>不要忘了 parseInt(..) 针对的是字符串值。非字符串参数会首先被强制类型转换为字符串(参见 4.2.1 节)，依赖这样的隐式强制类型 转换并非上策，应该避免向 parseInt(..) 传递非字符串参数。</p></div> <h3 id="显式转换为布尔值"><a href="#显式转换为布尔值" class="header-anchor">#</a> 显式转换为布尔值</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span>b  <span class="token comment">//true</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>在 if(..).. 这样的布尔值上下文中，如果没有使用 Boolean(..) 和 !!，就会自动隐式地进 行 ToBoolean 转换。建议使用 Boolean(..) 和 !! 来进行显式转换以便让代码更清晰易读。</p></div> <h2 id="隐式强制类型转换"><a href="#隐式强制类型转换" class="header-anchor">#</a> 隐式强制类型转换</h2> <h3 id="字符串和数字"><a href="#字符串和数字" class="header-anchor">#</a> 字符串和数字</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token comment">// &quot;420&quot;</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token comment">// &quot;1,23,4&quot;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>为了将值转换为相应的基本类型值，抽象操作 ToPrimitive(参见 ES5 规范 9.1 节)会首先 (通过内部操作 DefaultValue，参见 ES5 规范 8.12.8 节)检查该值是否有 valueOf() 方法。 如果有并且返回基本类型值，就使用该值进行强制类型转换。如果没有就使用 toString()
的返回值(如果存在)来进行强制类型转换。</p></div> <p>根据 ES5 规范 11.6.1 节，如果某个操作数是字符串或者能够通过以下步骤转换为字符串 的话，+ 将进行拼接操作。如果其中一个操作数是对象(包括数组)，则首先对其调用 ToPrimitive 抽象操作(规范 9.1 节)，该抽象操作再调用 [[DefaultValue]](规范 8.12.8 节)，以数字作为上下文。
你或许注意到这与 ToNumber 抽象操作处理对象的方式一样(参见 4.2.2 节)。因为数组的 valueOf() 操作无法得到简单基本类型值，于是它转而调用 toString()。因此上例中的两 个数组变成了 &quot;1,2&quot; 和 &quot;3,4&quot;。+ 将它们拼接后返回 &quot;1,23,4&quot;。
简单来说就是，如果 + 的其中一个操作数是字符串(或者通过以上步骤可以得到字符串)， 则执行字符串拼接;否则执行数字加法。</p> <blockquote><p>注意a+''和String（）的一个区别
a + &quot;&quot;(隐式)和前面的String(a)(显式)之间有一个细微的差别需要注意。根据 ToPrimitive抽象操作规则，a + &quot;&quot;会对a调用valueOf()方法，然后通过ToString抽象 操作将返回值转换为字符串。而 String(a) 则是直接调用 ToString()。</p></blockquote> <h3 id="布尔值和数字"><a href="#布尔值和数字" class="header-anchor">#</a> 布尔值和数字</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">onlyOne</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>b <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>c<span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span><span class="token operator">!</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>c<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span>a <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>b <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果其中有且仅有一个参数为 true，则 onlyOne(..) 返回 true</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token comment">//利用隐式转换成数字处理来优化</span>
 <span class="token keyword">function</span> <span class="token function">onlyOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 跳过假值，和处理0一样，但是避免了NaN if (arguments[i]) {</span>
        sum <span class="token operator">+=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> b<span class="token punctuation">,</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> b<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> b<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// false</span>
<span class="token function">onlyOne</span><span class="token punctuation">(</span> b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> b<span class="token punctuation">,</span> b<span class="token punctuation">,</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// false</span>

</code></pre></div><h3 id="和"><a href="#和" class="header-anchor">#</a> ||和&amp;&amp;</h3> <p>&amp;&amp; 和 || 运算符的返回值并不一定是布尔类型，而是两个操作数其中一个的值。|| 和 &amp;&amp; 首先会对第一个操作数(a 和 c)执行条件判断，如果其不是布尔值(如上例)就 先进行 ToBoolean 强制类型转换，然后再执行条件判断。</p> <blockquote><p>既然返回的不是true和false，为什么a &amp;&amp; (b || c)这样的表达式在 if 和 for 中没出过问题?
这或许并不是代码的问题，问题在于你可能不知道这些条件判断表达式最后还会执行布尔 值的隐式强制类型转换。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>b <span class="token operator">||</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;yep&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里a &amp;&amp; (b || c)的结果实际上是&quot;foo&quot;而非true，然后再由if将foo强制类型转换为
布尔值，所以最后结果为 true。</p> <h2 id="宽松相等和严格相等"><a href="#宽松相等和严格相等" class="header-anchor">#</a> 宽松相等和严格相等</h2> <p>== 允许在相等比较中进行强制类型转换，而 === 不允许。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>== 和 === 都会检查操作数的类型。区别在于操作数类型不同时它们的处理方式不同。</p></div> <h3 id=""><a href="#" class="header-anchor">#</a> &quot;==&quot;</h3> <ol><li>字符串和数字</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
a <span class="token operator">===</span> b<span class="token punctuation">;</span>    <span class="token comment">// false</span>
a <span class="token operator">==</span> b<span class="token punctuation">;</span>     <span class="token comment">// true</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>把是字符串类型的一边转换成数字类型</p></div> <ol start="2"><li>其他类型和布尔值</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;42&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
a <span class="token operator">==</span> b<span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>把布尔值转换成数字类型</p></div> <p>Type(x)是布尔值，所以ToNumber(x)将true强制类型转换为1，变成1 == &quot;42&quot;，二者的
类型仍然不同，&quot;42&quot; 根据规则被强制类型转换为 42，最后变成 1 == 42，结果为 false。</p> <p>应该避免写== true  == false</p> <ol start="3"><li>null和undefined
在 == 中 null 和 undefined 相等(它们也与其自身相等)，除此之外其他值都不存在这种
情况。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>a <span class="token operator">==</span> b<span class="token punctuation">;</span>     <span class="token comment">// true</span>
a <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
b <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
a <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
b <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
a <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token comment">// false</span>
b <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token comment">// false</span>
a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// false</span>
b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// false</span>
</code></pre></div><ol start="4"><li>对象和非对象</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">42</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token operator">==</span> b<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>把对象（对象/数组/函数）进行ToPrimitive(...）再进行比较</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'abc'</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">//和new String()一样</span>

a <span class="token operator">===</span> b <span class="token comment">//false</span>
a <span class="token operator">==</span> b  <span class="token comment">//true</span>
</code></pre></div><p>a == b结果为true，因为b通过ToPromitive进行强制类型转换(也称为“拆封”，英文为 unboxed 或者 unwrapped)，并返回标量基本类型值 &quot;abc&quot;，与 a 相等。</p> <div class="language-js extra-class"><pre class="language-js"><code>ar a <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 和Object()一样 </span>
a <span class="token operator">==</span> b<span class="token punctuation">;</span><span class="token comment">// false</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span> c <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 和Object()一样 </span>
c <span class="token operator">==</span> d<span class="token punctuation">;</span><span class="token comment">// false</span>
<span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token number">NaN</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span> e <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 和new Number( e )一样 </span>
e <span class="token operator">==</span> f<span class="token punctuation">;</span><span class="token comment">// false</span>

</code></pre></div><p>因为没有对应的封装对象，所以 null 和 undefined 不能够被封装(boxed)，Object(null) 和 Object() 均返回一个常规对象。
NaN能够被封装为数字封装对象，但拆封之后NaN == NaN返回false，因为NaN不等于NaN</p> <h3 id="一些不常见的情况"><a href="#一些不常见的情况" class="header-anchor">#</a> 一些不常见的情况</h3> <ol><li>返回其他数字</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">valueOf</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>ToPrimitive</p></div> <ol start="2"><li>假值的相等比较</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
<span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token number">NaN</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token string">&quot;0&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token number">NaN</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token comment">//true  记住!!</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//true [].toString() 是“”</span>
<span class="token boolean">false</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token number">NaN</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token string">&quot;&quot;</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token number">NaN</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// true -- 晕! // false</span>
<span class="token comment">// true</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// true -- 晕! // true -- 晕! // true -- 晕! // false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// true -- 晕! // true -- 晕! // false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// false</span>
<span class="token comment">// true -- 晕! // false</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// true</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>非严格模式下0  空字符串  false 归为一类，称为&quot;假值&quot;，null和undefined归为一类，称为&quot;空值&quot;</p></div> <p>根据 ToBoolean 规则，它会进行布尔 值的显式强制类型转换(同时反转奇偶校验位)。所以[] == ![]变成了[] == false。前 面我们讲过 false == []，最后的结果就顺理成章了。</p> <blockquote><p>• 如果两边的值中有 true 或者 false，千万不要使用 ==。</p> <p>• 如果两边的值中有 []、&quot;&quot; 或者 0，尽量不要使用 ==。</p> <p>这时最好用 === 来避免不经意的强制类型转换。这两个原则可以让我们避开几乎所有强制 类型转换的坑。</p></blockquote> <p>特别注意0 == “” 是true的情况</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//这里a传入0时容易出问题</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">:</span><span class="token operator">:</span><span class="token operator">:</span>tip
• 如果两边的值中有 <span class="token boolean">true</span> 或者 <span class="token boolean">false</span>，千万不要使用 <span class="token operator">==</span>。
• 如果两边的值中有 <span class="token punctuation">[</span><span class="token punctuation">]</span>、<span class="token string">&quot;&quot;</span> 或者 <span class="token number">0</span>，尽量不要使用 <span class="token operator">==</span>。
<span class="token operator">:</span><span class="token operator">:</span><span class="token operator">:</span>
</code></pre></div><h2 id="抽象关系比较"><a href="#抽象关系比较" class="header-anchor">#</a> 抽象关系比较</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>a &lt; b 中涉及的隐式强制类型转换不太引人注意</p></div> <p>比较双方首先调用 ToPrimitive，如果结果出现非字符串，就根据 ToNumber 规则将双方强制类型转换为数字来进行比较。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">42</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;43&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token operator">&lt;</span> b<span class="token punctuation">;</span>  <span class="token comment">// true</span>
b <span class="token operator">&lt;</span> a<span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre></div><p>如果比较双方都是字符串，则按字母顺序来进行比较:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;42&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;043&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token operator">&lt;</span> b<span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token operator">&lt;</span> b<span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">43</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
a <span class="token operator">&lt;</span> b<span class="token punctuation">;</span>  <span class="token comment">// false</span>
a <span class="token operator">==</span> b<span class="token punctuation">;</span> <span class="token comment">// false</span>
a <span class="token operator">&gt;</span> b<span class="token punctuation">;</span>  <span class="token comment">// false</span>
a <span class="token operator">&lt;=</span> b<span class="token punctuation">;</span> <span class="token comment">// true</span>
a <span class="token operator">&gt;=</span> b<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>a 和 b 并没有被转换为数字，因为 ToPrimitive 返回的是字符串，所以这里比较的是 &quot;42&quot; 和 &quot;043&quot; 两个字符串，它们分别以 &quot;4&quot; 和 &quot;0&quot; 开头。因为 &quot;0&quot; 在字母顺序上小于 &quot;4&quot;，所以 最后结果为 false。</p> <p>a 转换为 &quot;4, 2&quot;，b 转换为 &quot;0, 4, 3&quot;，同样是按字母顺序进行比较。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意: 根据规范a &lt;= b被处理为b &lt; a，然后将结果反转。因为b &lt; a的结果是false，所
以 a &lt;= b 的结果是 true  即 a &gt;= b，处理为 !(b &lt; a))</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/22/2022, 9:02:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cyx_blog/bookReading/dont_know_js 02/03-nativeFunction.html" class="prev">
        3.原生函数
      </a></span> <span class="next"><a href="/cyx_blog/bookReading/dont_know_js 02/05-grammar.html">
        5.语法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/cyx_blog/assets/js/app.ebd8d218.js" defer></script><script src="/cyx_blog/assets/js/2.080a46d6.js" defer></script><script src="/cyx_blog/assets/js/23.de7b4abf.js" defer></script>
  </body>
</html>
